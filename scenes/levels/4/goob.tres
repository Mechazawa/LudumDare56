[gd_resource type="BehaviorTree" load_steps=31 format=3 uid="uid://cbmgtei4j08wv"]

[ext_resource type="Script" path="res://ai/tasks/get_first_in_group.gd" id="1_oiica"]
[ext_resource type="Script" path="res://ai/tasks/count_nodes_in_group.gd" id="2_1284m"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_mrlsr"]
var/awake/name = &"awake"
var/awake/type = 1
var/awake/value = false
var/awake/hint = 0
var/awake/hint_string = "Goob awakes after being damaged"
var/target/name = &"target"
var/target/type = 24
var/target/hint = 0
var/target/hint_string = "Attack target"
var/missile_count/name = &"missile_count"
var/missile_count/type = 2
var/missile_count/value = 0
var/missile_count/hint = 0
var/missile_count/hint_string = ""

[sub_resource type="BBNode" id="BBNode_3xcsp"]
resource_name = "."
saved_value = NodePath(".")

[sub_resource type="BTCallMethod" id="BTCallMethod_d7f6c"]
node = SubResource("BBNode_3xcsp")
method = &"is_awake"
result_var = &"awake"

[sub_resource type="BTCheckTrigger" id="BTCheckTrigger_fe6k5"]
variable = &"awake"

[sub_resource type="BTInvert" id="BTInvert_0v15t"]
children = [SubResource("BTCheckTrigger_fe6k5")]

[sub_resource type="BBNode" id="BBNode_k6xeq"]
resource_name = "AnimationPlayer"
saved_value = NodePath("AnimationPlayer")

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_eupfe"]
await_completion = 2.0
animation_player = SubResource("BBNode_k6xeq")
animation_name = &"goob/sleep"

[sub_resource type="BTSequence" id="BTSequence_mxug8"]
children = [SubResource("BTCallMethod_d7f6c"), SubResource("BTInvert_0v15t"), SubResource("BTPlayAnimation_eupfe")]

[sub_resource type="BBNode" id="BBNode_oepyh"]
resource_name = "AnimationPlayer"
saved_value = NodePath("AnimationPlayer")

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_e0mdy"]
animation_player = SubResource("BBNode_oepyh")
animation_name = &"goob/RESET"

[sub_resource type="BTAction" id="BTAction_eco3o"]
script = ExtResource("1_oiica")
group = &"player"
output_var = &"target"

[sub_resource type="BBVariant" id="BBVariant_1a35y"]
resource_name = "$target"
value_source = 1
variable = &"target"

[sub_resource type="BTSetAgentProperty" id="BTSetAgentProperty_xfxl0"]
property = &"target"
value = SubResource("BBVariant_1a35y")

[sub_resource type="BBNode" id="BBNode_b78bc"]
resource_name = "AnimationPlayer"
saved_value = NodePath("AnimationPlayer")

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_6gtch"]
await_completion = 10.0
animation_player = SubResource("BBNode_b78bc")
animation_name = &"goob/attack_wave"

[sub_resource type="BTWait" id="BTWait_nc3h4"]
duration = 2.0

[sub_resource type="BTSequence" id="BTSequence_45ky8"]
children = [SubResource("BTPlayAnimation_6gtch"), SubResource("BTWait_nc3h4")]
metadata/_weight_ = 1.72035

[sub_resource type="BTAction" id="BTAction_r8ie7"]
script = ExtResource("2_1284m")
group = &"missile"
output_var = &"missile_count"

[sub_resource type="BBVariant" id="BBVariant_rucjv"]
resource_name = "0"
saved_value = 0
type = 2

[sub_resource type="BTCheckVar" id="BTCheckVar_s1unp"]
variable = &"missile_count"
value = SubResource("BBVariant_rucjv")

[sub_resource type="BBNode" id="BBNode_d60om"]
resource_name = "AnimationPlayer"
saved_value = NodePath("AnimationPlayer")

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_xo2ra"]
await_completion = 6.0
animation_player = SubResource("BBNode_d60om")
animation_name = &"goob/attack_homing_large"

[sub_resource type="BTWait" id="BTWait_t2jlb"]
duration = 4.0

[sub_resource type="BTSequence" id="BTSequence_gpmvq"]
children = [SubResource("BTAction_r8ie7"), SubResource("BTCheckVar_s1unp"), SubResource("BTPlayAnimation_xo2ra"), SubResource("BTWait_t2jlb")]
metadata/_weight_ = 3.09316

[sub_resource type="BTProbabilitySelector" id="BTProbabilitySelector_p55ce"]
children = [SubResource("BTSequence_45ky8"), SubResource("BTSequence_gpmvq")]

[sub_resource type="BTSequence" id="BTSequence_iw5hi"]
children = [SubResource("BTProbabilitySelector_p55ce")]
metadata/_weight_ = 6.6183

[sub_resource type="BTSequence" id="BTSequence_ua1gy"]
children = [SubResource("BTPlayAnimation_e0mdy"), SubResource("BTAction_eco3o"), SubResource("BTSetAgentProperty_xfxl0"), SubResource("BTSequence_iw5hi")]

[sub_resource type="BTSelector" id="BTSelector_nqnf8"]
children = [SubResource("BTSequence_mxug8"), SubResource("BTSequence_ua1gy")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_mrlsr")
root_task = SubResource("BTSelector_nqnf8")
